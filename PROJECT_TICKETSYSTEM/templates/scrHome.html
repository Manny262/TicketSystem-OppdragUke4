<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>home</title>
  </head>
  <body>
    <nav>
        <a href="{% url 'Newticket' %}">Lag ny sak</a>
        <a href="{% url 'logout' %}">logg ut</a>
    </nav>
    <h1>Welcome, {{ username }}!</h1>
    {% if messages %}
    <div class="messages">
      {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
    {% endif %} 
    
    {% if request.user.is_staff%}
        <form action="{% url 'home' %}" method="POST">
            {%csrf_token %}
            {% if allCasesView == True %}
                  <input type="hidden" name="inpallCasesView" id="inpallCasesView" value="False">
                <button type="submit">Se dine saker</button>
            {% else %}
                <input type="hidden" name="inpallCasesView" id="inpallCasesView" value="True">
                <button type="submit">Se alle saker</button>
            {% endif %}
        </form> 
    {% else %}
    <p>Du er ikke staff</p>
    {% endif %}
    <div class="container mt-4">
      <table class="table table-striped table-hover">
        <thead class="table-dark">
          <tr>
            <th>Ticket ID</th>
            <th>Title</th>
            <th>Status</th>
            <th>Created</th>
            <th>Deadline</th>
            <th>Case Manager</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for ticket in tickets %}
          <tr>
            <td>{{ ticket.Ticket_id }}</td>
            <td>{{ ticket.Title }}</td>
            <td>{{ ticket.get_Status_display }}</td>
            <td>{{ ticket.Created_at|date:"Y-m-d H:i" }}</td>
            <td>{{ ticket.Deadline }}</td>
            <td>
              {{ ticket.Casemanager_id.username|default:"Ingen saksbehandler" }}
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center">Du har ingen tickets</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </body>
</html>
